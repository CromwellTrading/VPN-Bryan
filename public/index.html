<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VPN Cuba - Inicio</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* VARIABLES Y RESET */
        :root {
            --primary: #0a0a1f;
            --secondary: #121230;
            --accent: #4f46e5;
            --accent-light: #6366f1;
            --accent-glow: rgba(79, 70, 229, 0.4);
            --text: #ffffff;
            --text-secondary: #a5b4fc;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --whatsapp: #25D366;
            --whatsapp-dark: #128C7E;
            --whatsapp-glow: rgba(37, 211, 102, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: var(--primary);
            color: var(--text);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        /* CONTAINER */
        .container {
            max-width: 500px;
            width: 100%;
            text-align: center;
        }

        /* LOGO */
        .logo {
            margin-bottom: 30px;
        }

        .logo-icon {
            font-size: 4rem;
            color: var(--accent);
            margin-bottom: 15px;
            filter: drop-shadow(0 0 20px var(--accent-glow));
        }

        .logo-text {
            font-size: 3rem;
            font-weight: 800;
            background: linear-gradient(135deg, #a5b4fc 0%, var(--accent) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .logo-subtitle {
            font-size: 1.1rem;
            color: var(--text-secondary);
        }

        /* CARD */
        .card {
            background: rgba(18, 18, 48, 0.9);
            border-radius: 20px;
            padding: 40px;
            border: 1px solid rgba(99, 102, 241, 0.2);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            margin-bottom: 30px;
        }

        /* USER INFO */
        .user-info {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .user-avatar {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--accent), var(--accent-light));
            border-radius: 50%;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
        }

        .user-name {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .user-id {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .user-admin {
            display: inline-block;
            background: linear-gradient(135deg, var(--warning), #f59e0b);
            color: #000;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-top: 10px;
        }

        /* BUTTONS */
        .buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .btn {
            padding: 18px;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            text-decoration: none;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent), var(--accent-light));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(79, 70, 229, 0.3);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-3px);
        }

        .btn-admin {
            background: linear-gradient(135deg, var(--warning), #f59e0b);
            color: #000;
        }

        .btn-admin:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(245, 158, 11, 0.3);
        }

        .btn-whatsapp {
            background: linear-gradient(135deg, var(--whatsapp), var(--whatsapp-dark));
            color: white;
        }

        .btn-whatsapp:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px var(--whatsapp-glow);
        }

        /* LOADING */
        .loading {
            text-align: center;
            padding: 40px;
        }

        .loading-spinner {
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top: 3px solid var(--accent);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* RESPONSIVE */
        @media (max-width: 600px) {
            .container {
                padding: 10px;
            }
            
            .card {
                padding: 30px 20px;
            }
            
            .logo-text {
                font-size: 2.5rem;
            }
            
            .logo-icon {
                font-size: 3rem;
            }
        }

        /* ERROR */
        .error {
            color: var(--error);
            text-align: center;
            padding: 20px;
            background: rgba(239, 68, 68, 0.1);
            border-radius: 12px;
            border: 1px solid rgba(239, 68, 68, 0.3);
            margin-bottom: 20px;
        }

        /* Modal de Términos y Condiciones */
        .terms-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(10, 10, 31, 0.98);
            z-index: 9999;
            display: none;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .terms-content {
            background: rgba(18, 18, 48, 0.95);
            border-radius: 20px;
            padding: 30px;
            max-width: 800px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            border: 2px solid var(--accent);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .terms-header {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .terms-header h2 {
            font-size: 1.8rem;
            color: var(--text);
            margin-bottom: 10px;
        }

        .terms-header p {
            color: var(--text-secondary);
        }

        .terms-documents {
            margin-bottom: 25px;
        }

        .doc-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 4px solid var(--accent);
        }

        .doc-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            color: var(--text);
            font-weight: 600;
        }

        .doc-title i {
            color: var(--accent);
        }

        .doc-summary {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.5;
            margin-bottom: 15px;
        }

        .doc-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: var(--accent-light);
            text-decoration: none;
            font-size: 0.85rem;
            padding: 8px 15px;
            background: rgba(79, 70, 229, 0.1);
            border-radius: 8px;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            font-family: inherit;
        }

        .doc-link:hover {
            background: rgba(79, 70, 229, 0.2);
            transform: translateY(-2px);
        }

        .terms-agreement {
            background: rgba(16, 185, 129, 0.1);
            border-radius: 12px;
            padding: 20px;
            margin: 25px 0;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .agreement-checkbox {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            cursor: pointer;
        }

        .agreement-checkbox input[type="checkbox"] {
            margin-top: 3px;
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .agreement-label {
            color: var(--text);
            font-size: 0.95rem;
            line-height: 1.4;
        }

        .agreement-label strong {
            color: var(--success);
        }

        .terms-buttons {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }

        .btn-accept {
            flex: 1;
            padding: 16px;
            background: linear-gradient(135deg, var(--success), #059669);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn-accept:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        .btn-accept:not(:disabled):hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(16, 185, 129, 0.3);
        }

        .btn-cancel {
            flex: 1;
            padding: 16px;
            background: rgba(239, 68, 68, 0.1);
            color: var(--error);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-cancel:hover {
            background: rgba(239, 68, 68, 0.2);
            transform: translateY(-3px);
        }

        /* Modal para documentos completos */
        .document-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(10, 10, 31, 0.98);
            z-index: 10000;
            display: none;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .document-content {
            background: rgba(18, 18, 48, 0.95);
            border-radius: 20px;
            padding: 30px;
            max-width: 800px;
            width: 100%;
            max-height: 85vh;
            overflow-y: auto;
            border: 2px solid var(--accent);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            position: relative;
        }

        .document-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .document-header h2 {
            font-size: 1.5rem;
            color: var(--text);
        }

        .close-doc-btn {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: var(--error);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.2rem;
        }

        .close-doc-btn:hover {
            background: rgba(239, 68, 68, 0.2);
            transform: rotate(90deg);
        }

        .document-body {
            color: var(--text-secondary);
            line-height: 1.6;
            font-size: 0.95rem;
        }

        .document-body h3 {
            color: var(--text);
            margin: 20px 0 10px;
            font-size: 1.2rem;
        }

        .document-body p {
            margin-bottom: 15px;
        }

        .document-body ul, .document-body ol {
            margin-left: 20px;
            margin-bottom: 15px;
        }

        .document-body li {
            margin-bottom: 8px;
        }

        .document-body strong {
            color: var(--text);
        }

        /* Scrollbar para términos */
        .terms-content::-webkit-scrollbar,
        .document-content::-webkit-scrollbar {
            width: 8px;
        }

        .terms-content::-webkit-scrollbar-track,
        .document-content::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
        }

        .terms-content::-webkit-scrollbar-thumb,
        .document-content::-webkit-scrollbar-thumb {
            background: var(--accent);
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <!-- Modal de Términos y Condiciones -->
    <div id="termsModal" class="terms-modal">
        <div class="terms-content">
            <div class="terms-header">
                <h2>Términos y Condiciones</h2>
                <p>Para continuar utilizando VPN Cuba, debes aceptar nuestros términos</p>
            </div>
            
            <div class="terms-documents">
                <div class="doc-section">
                    <div class="doc-title">
                        <i class="fas fa-shield-alt"></i>
                        <h3>Política de Privacidad</h3>
                    </div>
                    <p class="doc-summary">
                        Operamos bajo una estricta política de Cero Registros (No-Logs Policy). 
                        No registramos tu actividad de navegación, historial, tráfico, DNS o IP real.
                    </p>
                    <button class="doc-link" onclick="openDocument('privacy')">
                        <i class="fas fa-file-alt"></i>
                        Ver documento completo
                    </button>
                </div>
                
                <div class="doc-section">
                    <div class="doc-title">
                        <i class="fas fa-file-contract"></i>
                        <h3>Términos de Uso</h3>
                    </div>
                    <p class="doc-summary">
                        El servicio debe usarse exclusivamente con fines lícitos. 
                        Prohibido uso para actividades ilegales, fraudulentes o abusivas.
                    </p>
                    <button class="doc-link" onclick="openDocument('terms')">
                        <i class="fas fa-file-alt"></i>
                        Ver documento completo
                    </button>
                </div>
                
                <div class="doc-section">
                    <div class="doc-title">
                        <i class="fas fa-hand-holding-usd"></i>
                        <h3>Política de Reembolso</h3>
                    </div>
                    <p class="doc-summary">
                        Garantía de devolución de dinero de 7 días para la primera compra, 
                        sujeto a condiciones técnicas específicas.
                    </p>
                    <button class="doc-link" onclick="openDocument('refund')">
                        <i class="fas fa-file-alt"></i>
                        Ver documento completo
                    </button>
                </div>
            </div>
            
            <div class="terms-agreement">
                <label class="agreement-checkbox">
                    <input type="checkbox" id="acceptTermsCheckbox">
                    <span class="agreement-label">
                        <strong>He leído y acepto</strong> los Términos y Condiciones, 
                        Política de Privacidad y Política de Reembolso de VPN Cuba. 
                        Entiendo que mi información se manejará según la política de privacidad.
                    </span>
                </label>
            </div>
            
            <div class="terms-buttons">
                <button id="acceptTermsBtn" class="btn-accept" disabled>
                    <i class="fas fa-check-circle"></i>
                    Aceptar y Continuar
                </button>
                <button id="cancelTermsBtn" class="btn-cancel">
                    <i class="fas fa-times"></i>
                    Cancelar
                </button>
            </div>
        </div>
    </div>

    <!-- Modal para documentos completos -->
    <div id="documentModal" class="document-modal">
        <div class="document-content">
            <div class="document-header">
                <h2 id="docTitle">Documento</h2>
                <button class="close-doc-btn" onclick="closeDocument()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="docContent" class="document-body">
                <!-- El contenido se insertará aquí -->
            </div>
        </div>
    </div>

    <div class="container">
        <!-- LOGO -->
        <div class="logo">
            <div class="logo-icon">
                <i class="fas fa-shield-alt"></i>
            </div>
            <h1 class="logo-text">VPN CUBA</h1>
            <p class="logo-subtitle">Conexión de baja latencia para gaming</p>
        </div>

        <!-- CARD -->
        <div class="card">
            <!-- LOADING -->
            <div id="loading" class="loading">
                <div class="loading-spinner"></div>
                <p>Detectando usuario...</p>
            </div>

            <!-- USER INFO -->
            <div id="userInfo" class="user-info" style="display: none;">
                <div class="user-avatar">
                    <i class="fas fa-user"></i>
                </div>
                <h2 id="userName" class="user-name"></h2>
                <p id="userId" class="user-id"></p>
                <div id="adminBadge" class="user-admin" style="display: none;">
                    <i class="fas fa-crown"></i> Administrador
                </div>
            </div>

            <!-- ERROR -->
            <div id="error" class="error" style="display: none;">
                <i class="fas fa-exclamation-triangle"></i>
                <p id="errorText">No se pudo detectar el usuario. Por favor, abre esta página desde el bot de Telegram.</p>
            </div>

            <!-- BUTTONS -->
            <div id="buttons" class="buttons" style="display: none;">
                <a id="plansBtn" class="btn btn-primary" href="#">
                    <i class="fas fa-rocket"></i>
                    <span>Ver Planes</span>
                </a>
                
                <a id="statusBtn" class="btn btn-secondary" href="#">
                    <i class="fas fa-crown"></i>
                    <span>Mi Estado VIP</span>
                </a>
                
                <!-- NUEVO BOTÓN DE WHATSAPP -->
                <a class="btn btn-whatsapp" href="https://chat.whatsapp.com/BYa6hrCs4jkAuefEGwZUY9?mode=hqrc" target="_blank">
                    <i class="fab fa-whatsapp"></i>
                    <span>Grupo WhatsApp</span>
                </a>
                
                <a id="adminBtn" class="btn btn-admin" href="#" style="display: none;">
                    <i class="fas fa-cog"></i>
                    <span>Panel de Administración</span>
                </a>
            </div>
        </div>
    </div>

    <script>
        // Variables globales
        let telegramUserId = null;
        let userName = 'Usuario';
        let isAdminUser = false;
        let initialized = false;
        let termsAccepted = false;

        // Inicializar Telegram WebApp
        const tg = window.Telegram && window.Telegram.WebApp;

        // Contenido de los documentos
        const documents = {
            privacy: `
                <h3>POLÍTICA DE PRIVACIDAD VPN CUBA</h3>
                <p><strong>Última actualización: Noviembre de 2025</strong></p>
                
                <p>En VPN Cuba, tu privacidad y seguridad son nuestra máxima prioridad. Operamos bajo una
                estricta política de Cero Registros (No-Logs Policy) diseñada para asegurar que tu actividad en
                línea permanezca completamente privada.</p>
                
                <h3>1. Nuestro Compromiso: Cero Registros de Actividad</h3>
                <p>VPN Cuba NO registra, almacena ni monitorea la actividad de nuestros usuarios.</p>
                
                <p><strong>No registramos:</strong></p>
                <ul>
                    <li>Tu actividad de navegación, historial de sitios web visitados o el contenido de tus
                    comunicaciones.</li>
                    <li>Registros de tráfico (qué datos se envían o reciben).</li>
                    <li>Registros de DNS (solicitudes a sitios web).</li>
                    <li>Tu dirección IP real (externa) ni la dirección IP asignada por nuestra VPN.</li>
                </ul>
                
                <p>Esto significa que, incluso si se nos solicitara información, no tendríamos nada que compartir
                sobre tu actividad en línea.</p>
                
                <h3>2. Información Necesaria que Sí Recolectamos</h3>
                <p>Para operar y mantener el servicio, solo recopilamos la siguiente información mínima necesaria:</p>
                
                <p><strong>Información de la Cuenta:</strong> Tu nombre de usuario o ID de Cliente y la información de contacto
                (generalmente un correo electrónico o nombre de Telegram) que proporcionas para la creación y
                gestión de tu cuenta.</p>
                
                <p><strong>Información de Pago:</strong> Los datos necesarios para procesar tu compra (ej: confirmación de la
                transferencia, ID de transacción de PayPal o USDT). Nunca almacenamos números de tarjetas
                de crédito o información bancaria sensible.</p>
                
                <p><strong>Datos de Conexión Mínimos y Anónimos:</strong> Mantenemos un registro anónimo y agregado del total
                de ancho de banda consumido o el tiempo de conexión del usuario únicamente para fines de
                gestión de red (evitar abusos y optimizar la carga del servidor). Esta información no puede ser
                vinculada a tu actividad específica.</p>
                
                <h3>3. El Protocolo WireGuard®</h3>
                <p>Utilizamos el protocolo WireGuard por su seguridad y eficiencia superior. Entendemos las
                preocupaciones de privacidad de WireGuard y hemos implementado configuraciones
                personalizadas para eliminar cualquier potencial riesgo de privacidad de registros temporales de
                IP, adhiriéndonos estrictamente a nuestra política No-Logs.</p>
                
                <h3>4. Uso de la Información</h3>
                <p>La información que recolectamos (la mínima detallada en la Sección 2) se utiliza únicamente
                para:</p>
                <ul>
                    <li>Crear, mantener y gestionar tu cuenta.</li>
                    <li>Procesar pagos y facturación.</li>
                    <li>Responder a solicitudes de soporte al cliente.</li>
                </ul>
            `,
            
            terms: `
                <h3>TÉRMINOS DE USO VPN CUBA</h3>
                <p><strong>Última actualización: Noviembre de 2025</strong></p>
                
                <p>Al adquirir y utilizar los servicios de VPN Cuba, usted (el "Cliente") acepta y se compromete a cumplir con los siguientes Términos y Condiciones.</p>
                
                <h3>1. Responsabilidad del Cliente</h3>
                <p><strong>1.1. Cumplimiento Legal:</strong> El Cliente es el único responsable de conocer y cumplir con todas las leyes y regulaciones locales, nacionales e internacionales aplicables en su ubicación al utilizar el servicio.</p>
                
                <p><strong>1.2. Uso Legal:</strong> El servicio VPN Cuba debe ser utilizado exclusivamente con fines lícitos. El uso del servicio para cualquier actividad ilegal, fraudulenta o abusiva está estrictamente prohibido y será motivo de suspensión o cancelación inmediata.</p>
                
                <p><strong>1.3. Datos de Cuenta:</strong> El Cliente es responsable de mantener la confidencialidad de su archivo de configuración (llave privada) y de su cuenta.</p>
                
                <h3>2. Uso Aceptable del Servicio (Prohibiciones)</h3>
                <p>Para garantizar la estabilidad y baja latencia para todos, el Cliente se compromete a NO utilizar el servicio para las siguientes actividades:</p>
                
                <ul>
                    <li><strong>Actividades Ilegales:</strong> Distribución o acceso a material ilegal, piratería (incluyendo torrents de contenido con derechos de autor), phishing, o cualquier forma de ciberdelincuencia.</li>
                    <li><strong>Ataques a la Red:</strong> Intentos de interrupción, hackeo o explotación de sistemas informáticos ajenos (incluyendo ataques DDoS, escaneo de puertos o spam).</li>
                    <li><strong>Abuso de Ancho de Banda:</strong> Uso excesivo y continuo que degrade significativamente el rendimiento del servidor para otros usuarios (ej. minería de criptomonedas o descargas masivas 24/7).</li>
                    <li><strong>Compartición No Autorizada:</strong> Compartir el archivo de configuración con terceros. Cada cuenta está destinada a un uso personal o familiar limitado.</li>
                </ul>
                
                <h3>3. Exclusión de Garantías y Limitación de Responsabilidad</h3>
                <p><strong>3.1. Rendimiento:</strong> Aunque VPN Cuba se esfuerza por ofrecer la mejor latencia y estabilidad, no garantiza que el servicio sea ininterrumpido, esté libre de errores o que el rendimiento del ping sea el mismo en todas las ubicaciones y momentos. El rendimiento puede variar debido a factores fuera de nuestro control.</p>
                
                <p><strong>3.2. Interrupción de Servicio:</strong> VPN Cuba puede realizar mantenimiento o experimentar fallas imprevistas. El Cliente acepta que no habrá reembolso o compensación por la interrupción temporal del servicio.</p>
                
                <h3>4. Suspensión y Terminación</h3>
                <p><strong>4.1. Violación:</strong> VPN Cuba se reserva el derecho de suspender o terminar inmediatamente el servicio de cualquier Cliente que viole estos Términos de Servicio o nuestra Política de Uso Aceptable, sin previo aviso ni reembolso.</p>
            `,
            
            refund: `
                <h3>POLÍTICA DE REEMBOLSO VPN CUBA</h3>
                <p><strong>Última actualización: Noviembre de 2025</strong></p>
                
                <p>En VPN Cuba, estamos seguros de ofrecer la mejor conexión de baja latencia para tu experiencia
                gamer. Si por alguna razón técnica nuestro servicio no cumple con lo prometido, ofrecemos una
                garantía clara:</p>
                
                <h3>1. Garantía de Devolución de Dinero (7 Días)</h3>
                <p>Ofrecemos una Garantía de Devolución de Dinero de 7 Días (siete días naturales) a partir de la
                fecha de la compra inicial del plan.</p>
                
                <p>Si no estás satisfecho con la calidad, velocidad, o estabilidad de la conexión durante este
                periodo de 7 días, puedes solicitar un reembolso completo.</p>
                
                <p><strong>Esta garantía solo aplica a la primera compra de un cliente.</strong> Las renovaciones o compras
                posteriores no son elegibles.</p>
                
                <h3>2. Condiciones Específicas para el Reembolso</h3>
                <p>Para solicitar un reembolso dentro del periodo de 7 días, el cliente debe cumplir con las
                siguientes condiciones:</p>
                
                <p><strong>Motivo Técnico:</strong> La solicitud debe estar basada en un problema técnico no resuelto relacionado
                con la incapacidad de conectar o una latencia (ping) inusualmente alta que el equipo de soporte
                no pudo solucionar.</p>
                
                <p><em>Nota:</em> Las velocidades o latencias que sean consistentes con las limitaciones de la conexión
                local del cliente no son motivo de reembolso.</p>
                
                <p><strong>Cumplimiento de Términos:</strong> El Cliente no debe haber violado nuestros Términos de Servicio (ej.
                no haber compartido la clave, no haber realizado abuso de ancho de banda o actividades
                ilegales).</p>
                
                <h3>3. Exclusiones y No Elegibilidad</h3>
                <p>No se otorgará un reembolso bajo las siguientes circunstancias:</p>
                
                <ul>
                    <li><strong>Expiración del Período:</strong> Solicitudes realizadas después del día 7 de la compra inicial.</li>
                    <li><strong>Renovaciones:</strong> Los pagos por renovación automática o manual no son reembolsables.</li>
                    <li><strong>Uso Abusivo:</strong> Si se comprueba el uso del servicio para actividades ilegales o la violación de
                    nuestros Términos de Servicio.</li>
                </ul>
                
                <h3>4. Proceso de Solicitud de Reembolso</h3>
                <p>Para iniciar una solicitud de reembolso:</p>
                
                <ol>
                    <li>Envía un correo electrónico a nuestro equipo de facturación: <strong>lolitogarcia0707@gmail.com</strong></li>
                    <li>Incluye: Tu ID de Cliente, la Fecha de Compra, y la Explicación Detallada del problema técnico no
                    resuelto.</li>
                </ol>
                
                <p>Nuestro equipo de soporte revisará la solicitud y te responderá en un plazo máximo de 72 horas
                hábiles con el estado de tu reembolso.</p>
            `
        };

        // Función para abrir documento
        function openDocument(type) {
            const titles = {
                'privacy': 'Política de Privacidad',
                'terms': 'Términos de Uso', 
                'refund': 'Política de Reembolso'
            };
            
            document.getElementById('docTitle').textContent = titles[type] || 'Documento';
            document.getElementById('docContent').innerHTML = documents[type] || 'Contenido no disponible';
            document.getElementById('documentModal').style.display = 'flex';
        }

        // Función para cerrar documento
        function closeDocument() {
            document.getElementById('documentModal').style.display = 'none';
        }

        // Función para obtener parámetros de la URL
        function getUrlParameter(name) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(name);
        }

        // Función para verificar si los términos fueron aceptados
        function checkTermsAccepted(userId) {
            const accepted = localStorage.getItem(`termsAccepted_${userId}`);
            const termsVersion = localStorage.getItem(`termsVersion_${userId}`);
            
            const currentVersion = '2025-11';
            
            if (accepted === 'true' && termsVersion === currentVersion) {
                return true;
            }
            return false;
        }

        // Función para guardar aceptación de términos
        function saveTermsAccepted(userId) {
            localStorage.setItem(`termsAccepted_${userId}`, 'true');
            localStorage.setItem(`termsVersion_${userId}`, '2025-11');
            localStorage.setItem(`termsAcceptedDate_${userId}`, new Date().toISOString());
        }

        // Función para mostrar modal de términos
        function showTermsModal() {
            const modal = document.getElementById('termsModal');
            modal.style.display = 'flex';
            
            const checkbox = document.getElementById('acceptTermsCheckbox');
            const acceptBtn = document.getElementById('acceptTermsBtn');
            
            checkbox.addEventListener('change', function() {
                acceptBtn.disabled = !this.checked;
            });
            
            acceptBtn.addEventListener('click', function() {
                if (checkbox.checked && telegramUserId) {
                    saveTermsAccepted(telegramUserId);
                    modal.style.display = 'none';
                    proceedAfterTermsAcceptance();
                }
            });
            
            document.getElementById('cancelTermsBtn').addEventListener('click', function() {
                modal.style.display = 'none';
                showError('Debes aceptar los términos para usar el servicio.');
            });
        }

        // Función para continuar después de aceptar términos
        async function proceedAfterTermsAcceptance() {
            try {
                const userInfo = await getUserInfo(telegramUserId);
                
                if (!userInfo) {
                    throw new Error('No se pudo obtener información del usuario');
                }

                showUserUI(telegramUserId, userInfo);
            } catch (error) {
                showError(error.message || 'Ocurrió un error inesperado');
            }
        }

        // Función para verificar si es administrador
        async function checkAdminStatus(userId) {
            try {
                const response = await fetch(`/api/check-admin/${userId}`);
                const data = await response.json();
                return data.isAdmin || false;
            } catch (error) {
                console.error('Error verificando admin:', error);
                return false;
            }
        }

        // Función para verificar estado VIP
        async function checkVIPStatus(userId) {
            try {
                const response = await fetch(`/api/user-info/${userId}`);
                const data = await response.json();
                return data.vip || false;
            } catch (error) {
                console.error('Error verificando VIP:', error);
                return false;
            }
        }

        // Función para obtener información del usuario
        async function getUserInfo(userId) {
            try {
                const response = await fetch(`/api/user-info/${userId}`);
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                const data = await response.json();
                
                if (data.error) {
                    throw new Error(data.error);
                }
                
                return data;
            } catch (error) {
                console.error('Error obteniendo información del usuario:', error);
                throw error;
            }
        }

        // Función para mostrar UI del usuario
        function showUserUI(userId, userInfo) {
            userName = userInfo.first_name || userInfo.username || 'Usuario';
            isAdminUser = userInfo.isAdmin || false;

            document.getElementById('userName').textContent = userName;
            document.getElementById('userId').textContent = `ID: ${userId}`;
            
            if (isAdminUser) {
                document.getElementById('adminBadge').style.display = 'block';
                document.getElementById('adminBtn').style.display = 'flex';
            }

            document.getElementById('loading').style.display = 'none';
            document.getElementById('userInfo').style.display = 'block';
            document.getElementById('buttons').style.display = 'flex';
            
            const plansUrl = `/plans.html?userId=${userId}`;
            const adminUrl = `/admin.html?userId=${userId}&admin=true`;
            
            document.getElementById('plansBtn').href = plansUrl;
            document.getElementById('adminBtn').href = adminUrl;

            document.getElementById('statusBtn').onclick = async function(e) {
                e.preventDefault();
                const isVIP = await checkVIPStatus(userId);
                
                if (isVIP) {
                    alert('✅ ¡Eres usuario VIP! Tu acceso está activo.');
                } else {
                    alert('❌ No eres usuario VIP aún. Selecciona un plan para convertirte en VIP.');
                    window.location.href = plansUrl;
                }
            };
            
            initialized = true;
        }

        // Función para manejar error
        function showError(message) {
            console.error('Error:', message);
            
            document.getElementById('loading').style.display = 'none';
            document.getElementById('error').style.display = 'block';
            document.getElementById('errorText').textContent = message;
            
            if (telegramUserId) {
                document.getElementById('buttons').style.display = 'flex';
            }
        }

        // Función principal de inicialización
        async function initializeApp() {
            if (initialized) return;
            
            try {
                if (tg) {
                    tg.expand();
                    tg.MainButton.hide();
                }

                telegramUserId = getUrlParameter('userId');
                
                if (!telegramUserId) {
                    if (tg && tg.initDataUnsafe && tg.initDataUnsafe.user) {
                        telegramUserId = tg.initDataUnsafe.user.id.toString();
                    }
                }
                
                if (!telegramUserId) {
                    showError('No se pudo detectar tu ID de Telegram. Asegúrate de abrir esta página desde el bot de Telegram.');
                    return;
                }

                termsAccepted = checkTermsAccepted(telegramUserId);
                
                if (!termsAccepted) {
                    document.getElementById('loading').style.display = 'none';
                    showTermsModal();
                    return;
                }

                const userInfo = await getUserInfo(telegramUserId);
                
                if (!userInfo) {
                    throw new Error('No se pudo obtener información del usuario');
                }

                showUserUI(telegramUserId, userInfo);

            } catch (error) {
                showError(error.message || 'Ocurrió un error inesperado');
            }
        }

        // Inicializar cuando se carga la página
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(initializeApp, 100);
        });

        if (tg) {
            tg.ready();
        }
    </script>
</body>
</html>
