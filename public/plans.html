<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VPN Cuba - Planes</title>
    <link rel="stylesheet" href="/css/style.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>VPN CUBA</h1>
            <p class="subtitle">NUESTROS PLANES OPTIMIZADOS</p>
        </div>
        
        <div class="plans-container">
            <!-- Plan B√°sico -->
            <div class="plan-card">
                <div class="plan-header">
                    <h3 class="plan-title">B√°sico</h3>
                    <p class="plan-period">(1 mes)</p>
                </div>
                <div class="plan-price">
                    <span class="currency">$</span>
                    <span class="amount">800</span>
                    <span class="currency-suffix">CUP</span>
                </div>
                <div class="plan-features">
                    <div class="feature">
                        <span class="feature-icon">‚úÖ</span>
                        <span class="feature-text">Baja Latencia</span>
                    </div>
                    <div class="feature">
                        <span class="feature-icon">‚úÖ</span>
                        <span class="feature-text">Ancho de Banda Ilimitado</span>
                    </div>
                    <div class="feature">
                        <span class="feature-icon">‚úÖ</span>
                        <span class="feature-text">Soporte Prioritario</span>
                    </div>
                </div>
                <button class="btn-plan" onclick="selectPlan('basico', 800)">
                    <span class="btn-icon">üõí</span>
                    <span class="btn-text">COMPRAR</span>
                </button>
            </div>

            <!-- Plan Premium -->
            <div class="plan-card featured">
                <div class="plan-badge">¬°Ahorras $300 CUP!</div>
                <div class="plan-header">
                    <h3 class="plan-title">Premium</h3>
                    <p class="plan-period">(2 meses)</p>
                </div>
                <div class="plan-price">
                    <span class="currency">$</span>
                    <span class="amount">1,300</span>
                    <span class="currency-suffix">CUP</span>
                </div>
                <div class="plan-savings">
                    <span class="savings-icon">üí∞</span>
                    <span class="savings-text">¬°Ahorras $300 CUP!</span>
                </div>
                <div class="plan-features">
                    <div class="feature">
                        <span class="feature-icon">‚úÖ</span>
                        <span class="feature-text">Todo lo del B√°sico</span>
                    </div>
                    <div class="feature">
                        <span class="feature-icon">‚úÖ</span>
                        <span class="feature-text">2 meses de servicio</span>
                    </div>
                    <div class="feature">
                        <span class="feature-icon">‚úÖ</span>
                        <span class="feature-text">Soporte 24/7</span>
                    </div>
                </div>
                <button class="btn-plan featured" onclick="selectPlan('premium', 1300)">
                    <span class="btn-icon">üî•</span>
                    <span class="btn-text">COMPRAR</span>
                </button>
            </div>

            <!-- Plan VIP -->
            <div class="plan-card vip">
                <div class="plan-badge vip-badge">¬°MEJOR OFERTA!</div>
                <div class="plan-header">
                    <h3 class="plan-title">VIP</h3>
                    <p class="plan-period">(6 meses)</p>
                </div>
                <div class="plan-price">
                    <span class="currency">$</span>
                    <span class="amount">3,000</span>
                    <span class="currency-suffix">CUP</span>
                </div>
                <div class="plan-savings vip-savings">
                    <span class="savings-icon">üëë</span>
                    <span class="savings-text">¬°Ahorras $1,800 CUP!</span>
                </div>
                <div class="plan-subtitle">
                    <p>¬°Solo $500 CUP/mes con el Plan VIP!</p>
                </div>
                <div class="plan-features">
                    <div class="feature">
                        <span class="feature-icon">‚úÖ</span>
                        <span class="feature-text">Todo lo del Premium</span>
                    </div>
                    <div class="feature">
                        <span class="feature-icon">‚úÖ</span>
                        <span class="feature-text">6 meses de servicio</span>
                    </div>
                    <div class="feature">
                        <span class="feature-icon">‚úÖ</span>
                        <span class="feature-text">Configuraci√≥n personalizada</span>
                    </div>
                    <div class="feature">
                        <span class="feature-icon">‚úÖ</span>
                        <span class="feature-text">Soporte dedicado</span>
                    </div>
                </div>
                <button class="btn-plan vip-btn" onclick="selectPlan('vip', 3000)">
                    <span class="btn-icon">üëë</span>
                    <span class="btn-text">COMPRAR</span>
                </button>
            </div>
        </div>

        <div class="features-summary">
            <h3>‚úÖ Todos los planes incluyen:</h3>
            <div class="features-grid">
                <div class="feature-item">
                    <span class="feature-icon">‚ö°</span>
                    <span class="feature-name">Baja Latencia</span>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">üì∂</span>
                    <span class="feature-name">Ancho de Banda Ilimitado</span>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">üõ°Ô∏è</span>
                    <span class="feature-name">Soporte Prioritario</span>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>Para comprar, selecciona un plan y completa el pago</p>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        
        const urlParams = new URLSearchParams(window.location.search);
        const userId = urlParams.get('userId') || tg.initDataUnsafe.user?.id;
        
        function selectPlan(planType, price) {
            localStorage.setItem('selectedPlan', JSON.stringify({
                type: planType,
                price: price,
                userId: userId
            }));
            
            window.location.href = `/payment.html?userId=${userId}&plan=${planType}&price=${price}`;
        }
        
        // Verificar t√©rminos
        async function checkTerms() {
            try {
                const response = await fetch(`/api/check-terms/${userId}`);
                const data = await response.json();
                
                if (!data.accepted) {
                    window.location.href = `/index.html?userId=${userId}`;
                }
            } catch (error) {
                console.error('Error verificando t√©rminos:', error);
            }
        }
        
        if (userId) checkTerms();
    </script>
</body>
</html>
